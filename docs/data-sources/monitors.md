---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "uptrace_monitors Data Source - uptrace"
subcategory: ""
description: |-
  Fetches a list of Uptrace monitors with optional filtering.
---

# uptrace_monitors (Data Source)

Fetches a list of Uptrace monitors with optional filtering.

## Example Usage

```terraform
# List all monitors in the project
data "uptrace_monitors" "all" {}

output "all_monitors_count" {
  description = "Total number of monitors"
  value       = length(data.uptrace_monitors.all.monitors)
}

output "all_monitor_names" {
  description = "Names of all monitors"
  value       = [for m in data.uptrace_monitors.all.monitors : m.name]
}

# Filter monitors by type
data "uptrace_monitors" "metric_monitors" {
  type = "metric"
}

output "metric_monitors_count" {
  description = "Number of metric monitors"
  value       = length(data.uptrace_monitors.metric_monitors.monitors)
}

# Filter monitors by state
data "uptrace_monitors" "firing_monitors" {
  state = "firing"
}

output "firing_monitors" {
  description = "List of currently firing monitors"
  value = [
    for m in data.uptrace_monitors.firing_monitors.monitors : {
      name  = m.name
      type  = m.type
      state = m.state
    }
  ]
}

# Filter monitors by name (substring match)
data "uptrace_monitors" "cpu_monitors" {
  name = "CPU"
}

output "cpu_monitors" {
  description = "Monitors with 'CPU' in the name"
  value = [
    for m in data.uptrace_monitors.cpu_monitors.monitors : {
      id   = m.id
      name = m.name
      type = m.type
    }
  ]
}

# Combine multiple filters
data "uptrace_monitors" "critical_metric_monitors" {
  type  = "metric"
  state = "firing"
  name  = "critical"
}

output "critical_alerts" {
  description = "Critical metric monitors currently firing"
  value       = data.uptrace_monitors.critical_metric_monitors.monitors
}

# Use in locals for processing
locals {
  all_monitors = data.uptrace_monitors.all.monitors

  # Group monitors by type
  monitors_by_type = {
    for m in local.all_monitors :
    m.type => m...
  }

  # Get IDs of all firing monitors
  firing_monitor_ids = [
    for m in local.all_monitors :
    m.id if m.state == "firing"
  ]

  # Count monitors by state
  monitors_by_state = {
    for m in local.all_monitors :
    m.state => length([for mon in local.all_monitors : mon if mon.state == m.state])...
  }
}

output "monitors_summary" {
  description = "Summary of monitors by type and state"
  value = {
    total              = length(local.all_monitors)
    by_type            = { for k, v in local.monitors_by_type : k => length(v) }
    firing_count       = length(local.firing_monitor_ids)
    firing_monitor_ids = local.firing_monitor_ids
  }
}

# Reference monitors created in the same configuration
resource "uptrace_monitor" "example" {
  name = "Example Monitor"
  type = "metric"

  params = {
    metrics = [{
      name  = "system.cpu.utilization"
      alias = "$cpu"
    }]
    query             = "avg($cpu) > 90"
    max_allowed_value = 90
  }
}

# List all monitors including the one just created
data "uptrace_monitors" "with_new_monitor" {
  depends_on = [uptrace_monitor.example]
}

# Verify the new monitor appears in the list
output "new_monitor_exists" {
  description = "Check if the new monitor is in the list"
  value = anytrue([
    for m in data.uptrace_monitors.with_new_monitor.monitors :
    m.name == "Example Monitor"
  ])
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `name` (String) Filter monitors by name (case-insensitive substring match).
- `state` (String) Filter monitors by state (open, firing, paused).
- `type` (String) Filter monitors by type (metric or error).

### Read-Only

- `monitors` (Attributes List) List of monitors matching the filter criteria. (see [below for nested schema](#nestedatt--monitors))

<a id="nestedatt--monitors"></a>
### Nested Schema for `monitors`

Read-Only:

- `channel_ids` (List of Number) List of notification channel IDs.
- `created_at` (String) Monitor creation timestamp.
- `id` (String) Monitor identifier.
- `name` (String) Monitor name.
- `notify_everyone_by_email` (Boolean) Whether to notify all project members by email.
- `params` (Attributes) Monitor parameters (metric or error specific). (see [below for nested schema](#nestedatt--monitors--params))
- `repeat_interval` (Attributes) Repeat interval configuration. (see [below for nested schema](#nestedatt--monitors--repeat_interval))
- `state` (String) Current monitor state (open, firing, paused).
- `team_ids` (List of Number) List of team IDs to notify.
- `trend_agg_func` (String) Trend aggregation function for monitor evaluation. Required for Uptrace cloud API, optional for self-hosted v2.0.2 and earlier. Valid values: avg, sum, min, max, p50, p90, p95, p99.
- `type` (String) Monitor type (metric or error).
- `updated_at` (String) Monitor last update timestamp.

<a id="nestedatt--monitors--params"></a>
### Nested Schema for `monitors.params`

Read-Only:

- `check_num_point` (Number) Number of consecutive points that must breach threshold.
- `column` (String) Column name to evaluate (metric monitors only).
- `grouping_interval` (Number) Grouping interval in milliseconds.
- `max_allowed_value` (Number) Maximum allowed value for the metric.
- `metrics` (Attributes List) List of metrics to monitor. (see [below for nested schema](#nestedatt--monitors--params--metrics))
- `min_allowed_value` (Number) Minimum allowed value for the metric.
- `nulls_mode` (String) How to handle null values: allow, forbid, or convert.
- `query` (String) UQL query for metric evaluation or error filtering.
- `time_offset` (Number) Time offset in milliseconds.

<a id="nestedatt--monitors--params--metrics"></a>
### Nested Schema for `monitors.params.metrics`

Read-Only:

- `alias` (String) Optional alias for the metric.
- `name` (String) Metric name.



<a id="nestedatt--monitors--repeat_interval"></a>
### Nested Schema for `monitors.repeat_interval`

Read-Only:

- `interval` (Number) Custom interval in seconds.
- `strategy` (String) Repeat interval strategy (default or custom).
